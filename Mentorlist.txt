********************************************
// lay mentor rating theo location va top rating
SELECT 
	u.id, u.name, u.location, u.role , j.name as jobtitle
	,COALESCE(AVG(f.rating),0) as average_rating
FROM Userr u
JOIN Jobtitle j ON  u.jobtitle = j.id
LEFT JOIN Program p ON u.id = p.user_id
LEFT JOIN Feedback f ON p.id = f.program_id AND f.receiver_id = u.id
WHERE u.location = 'Ho Chi Minh' AND u.role = 'Mentor'
GROUP BY u.id, u.name, u.location, j.name, u.role
ORDER BY average_rating DESC;

********************************************
// Lay mentor theo top rating
SELECT 
	u.id, u.name, u.location, j.name as jobtitle, u.role
	,COALESCE(AVG(f.rating),0) as average_rating
FROM Userr u
JOIN Jobtitle j ON  u.jobtitle = j.id
LEFT JOIN Program p ON u.id = p.user_id
LEFT JOIN Feedback f ON p.id = f.program_id AND f.receiver_id = u.id
WHERE u.role = 'Mentor'
GROUP BY u.id, u.name, u.location, j.name, u.role
ORDER BY average_rating DESC;

********************************************
// Lay mentor theo jobtitle va top rating
SELECT 
	u.id, u.name, u.location, j.name as jobtitle, u.role
	,COALESCE(AVG(f.rating),0) as average_rating
FROM Userr u
JOIN Jobtitle j ON  u.jobtitle = j.id
LEFT JOIN Program p ON u.id = p.user_id
LEFT JOIN Feedback f ON p.id = f.program_id AND f.receiver_id = u.id
WHERE u.role = 'Mentor' and j.name = 'Senior Software Engineer'
GROUP BY u.id, u.name, u.location, j.name, u.role
ORDER BY average_rating DESC;